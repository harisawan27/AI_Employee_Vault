---
name: reason-and-plan
description: Full Perception-Reasoning-Action loop. Scans /Needs_Action for pending items, reads Company Handbook rules, creates a Plan file with step-by-step checklist, executes AUTO items, routes APPROVE items through approval workflow, and updates Dashboard. Use for autonomous inbox processing with planning.
user-invocable: true
argument-hint: [optional: specific task file to focus on]
---

# Reason and Plan — WEBXES Tech AI Employee

Execute the full Perception → Reasoning → Action pipeline.

## Phase 1: Perception (Scan)

1. **Read Company Handbook** (`Company_Handbook.md`) — load all rules
2. **Scan `/Needs_Action/`** — list all pending files
3. **Read each file** — extract frontmatter (type, priority, status)
4. If `$ARGUMENTS` specifies a file, focus on that file only

If `/Needs_Action/` is empty, report "No pending items" and stop.

## Phase 2: Reasoning (Plan)

For each item found, determine:
- **What type** is it? (email, file_drop, ceo_briefing, payment, social_media, other)
- **What action** is needed? (reply, forward, pay, post, review, archive)
- **What autonomy level** applies? (AUTO, NOTIFY, APPROVE per handbook)
- **What are the dependencies?** (needs data from another file, needs external API)

Create a plan file at `Plans/PLAN_<summary>_<date>.md`:

```markdown
---
type: plan
generated: <ISO timestamp>
items_count: <number of items>
status: executing
---

# Execution Plan — <date>

Generated by WEBXES Tech AI Employee

## Items to Process

### 1. <Item Name>
- **File:** `<filename>`
- **Type:** <type>
- **Priority:** <priority>
- **Autonomy:** <AUTO | NOTIFY | APPROVE>
- **Action:** <what will be done>
- [ ] Step 1: <specific step>
- [ ] Step 2: <specific step>

### 2. <Item Name>
...

## Summary
- AUTO items: <count> (will execute now)
- NOTIFY items: <count> (will execute and notify)
- APPROVE items: <count> (will route to approval)
```

## Phase 3: Action (Execute)

Process items in priority order (high → normal → low):

### AUTO Items
- Execute the action directly
- Log to `/Logs/`
- Move source file to `/Done/`
- Check off steps in the plan file

### NOTIFY Items
- Execute the action
- Log to `/Logs/`
- Move source file to `/Done/`
- Note in plan file for CEO awareness

### APPROVE Items
- Use `/request-approval` skill (or create approval file directly)
- Write approval file to `/Pending_Approval/<domain>/`
- Do NOT execute the action
- Do NOT move source file (leave in `/Needs_Action/` until approved)
- Note in plan file as "awaiting approval"

## Phase 4: Update

1. **Update the plan file** — mark status as `completed` or `partial`
2. **Run `/update-dashboard`** — refresh Dashboard.md with new state
3. **Report summary** to user:
   - Items processed (with autonomy levels)
   - Items routed to approval
   - Any errors or escalations
   - Plan file location

## Safety Rules

- Follow Company Handbook over all other sources
- Never execute APPROVE-level actions without approval
- If `DRY_RUN=true`, log intended actions but do NOT execute external calls
- If in doubt: **ask, don't act**
- Never delete files — only move them
